# ZENOMEDIA SERVER V0.1
volumes:
  romm_db_data:

services:
  # +++++++++++++++++++++++++++++++
  # 
  # CATEGORIA: DASHBOARDS / PORTALES
  # 
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- heimdall
  # --- Dashboard / portal de accesos
  # --- Ports: 7771 (Gui Web)
  # --------------------------------------------------------
  heimdall:
    image: linuxserver/heimdall
    container_name: heimdall
    restart: unless-stopped
    ports:
      - "7771:80"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/heimdall:/config"

  # --------------------------------------------------------
  # --- homarr
  # --- Dashboard / portal de accesos
  # --- Ports: 7575 (Gui Web)
  # --------------------------------------------------------
  homarr:
    image: ghcr.io/homarr-labs/homarr:latest
    container_name: homarr
    restart: unless-stopped
    ports:
      - "7575:7575"
    environment:
      - SECRET_ENCRYPTION_KEY=9F32AFA73371B50FA139FED313838FA0091002277E483B27DDD1D3162B93DD02
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - "E:/Docker_folders/homarr/appdata:/appdata"
     
    

  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: MEDIA STREAMING Y BIBLIOTECAS
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- jellyfin
  # --- Media server / streaming
  # --- Ports: 8096 (Gui Web)
  # --------------------------------------------------------
  jellyfin:
    image: jellyfin/jellyfin:10.11.4
    container_name: jellyfin
    ports:
      - "8096:8096"
      - "8920:8920"
      - "7359:7359/udp"
    environment:
      TZ: Europe/Madrid
      UMASK: "022"
      JELLYFIN_PublishedServerUrl: "${JELLYFIN_PUBLISHED_URL}"
      NVIDIA_VISIBLE_DEVICES: all
      NVIDIA_DRIVER_CAPABILITIES: compute,video,utility
      LOG_LEVEL: debug
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    volumes:
      # CONFIG
      # Carpeta completa del cliente web
      - "E:/Docker_folders/jellifyn/jellyfin-web:/jellyfin/jellyfin-web"
      # Logos extra para CSS
      # -"E:/Docker_folders/jellifyn/custom-logos:/jellyfin/jellyfin-web/custom-logos:ro"
      # UNIDAD DE ALMACENAMIENTO F (CONTENIDO MULTIMEDIA):
      - "F:/Animacion:/media/Animacion"
      - "F:/Infantil:/media/Infantil"
      - "F:/Peliculas:/media/Peliculas"
      - "F:/Documentales:/media/Documentales"
      - "F:/Series:/media/Series"
      - "F:/MiniSeries:/media/MiniSeries"
      - "F:/Anime:/media/Anime"
      - "F:/Futbol:/media/Futbol"
      - "F:/Baloncesto:/media/Baloncesto"
      - "F:/NFL:/media/NFL"
      - "F:/Combates:/media/Combates"
      - "F:/LoL:/media/LoL"
      - "F:/Olimpiadas:/media/Olimpiadas"
      - "F:/Podcasts:/media/Podcast"
      # UNIDAD DE ALMACENAMIENTO E (CONTENIDO MULTIMEDIA):
      - "E:/Animacion:/media/Animacion2"
      - "E:/Infantil:/media/Infantil2"
      - "E:/Peliculas:/media/Peliculas2"
      - "E:/Series:/media/Series2"
      - "E:/MiniSeries:/media/MiniSeries2"
      - "E:/YouTube:/media/YouTube2"
      - "E:/Anime:/media/Anime2"
      - "E:/Documentales:/media/Documentales2"
      - "E:/Futbol:/media/Futbol2"
      - "E:/Baloncesto:/media/Baloncesto2"
      - "E:/NFL:/media/NFL2"
      - "E:/Combates:/media/Combates2"
      - "E:/LoL:/media/LoL2"
      - "E:/Olimpiadas:/media/Olimpiadas2"
      - "E:/Podcasts:/media/Podcast2"
      # PATHS DE CONFIGURACION E:
      - "E:/Docker_folders/jellifyn/metadata:/config"
      - "C:/Docker_folders/jellifyn/cache:/cache"
      - "C:/Docker_folders/jellifyn/transcodes:/transcode"
      # GRABACIONES:
      - "E:/Grabaciones:/recordings"
      # SCRIPTS
      - "E:/Docker_folders/jellifyn/scripts:/scripts"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-fsS", "http://localhost:8096/health"]
      interval: 30s
      timeout: 5s
      retries: 5
      start_period: 60s

  # --------------------------------------------------------
  # --- jfa-go
  # --- Gestión de usuarios Jellyfin
  # --- Ports: 8056 (Gui Web)
  # --------------------------------------------------------
  jfa-go:
    image: hrfee/jfa-go:latest
    container_name: jfa-go
    depends_on: [jellyfin]
    ports:
      - "8056:8056"
    environment:
      - TZ=Europe/Madrid
      - JELLYFIN_URL=http://jellyfin:8096
    volumes:
      - "E:/Docker_folders/jfa-go:/data"
      - "E:/Docker_folders/jellifyn/metadata:/jf:ro"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- komga
  # --- Biblioteca de cómics/manga (servidor)
  # --- Ports: 33083 (Gui Web)
  # --------------------------------------------------------
  komga:
    image: gotson/komga:latest
    container_name: komga
    ports: ["33083:25600"]
    environment:
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/komga/komga_config:/config"
      - "E:/Docker_folders/komga/komga_data:/data"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- calibre
  # --- Gestión de biblioteca de ebooks (GUI web/noVNC)
  # --- Ports: 33084 (Gui Web)
  # --------------------------------------------------------
  calibre:
    image: lscr.io/linuxserver/calibre:latest
    container_name: calibre
    ports:
      - "33084:8080"
      - "33085:8181"
      - "33087:8081"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/calibre/calibre_config:/config"
    restart: unless-stopped


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: DESCARGAS Y CAPTURA DE CONTENIDO
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- qbittorrent
  # --- Cliente BitTorrent
  # --- Ports: 8080 (Gui Web)
  # --------------------------------------------------------
  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent:latest
    container_name: qbittorrent
    ports:
      - "8080:8080"
      - "6881:6881"
      - "6881:6881/udp"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
      - WEBUI_PORT=8080
      - TORRENTING_PORT=6881
    volumes:
      - "E:/Docker_folders/qbittorrent/qbittorrent_data:/config"
      - "E:/Docker_folders/qbittorrent/media_data:/downloads"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- amule
  # --- Cliente eD2k/Kad (aMule) con Web UI
  # --- Ports: 4711 (Gui Web)
  # --------------------------------------------------------
  amule:
    image: ngosang/amule:latest
    container_name: amule
    environment:
      - TZ=Europe/Madrid
      - PUID=1000
      - PGID=1000
      # passwords de la UI web y control remoto (recomendado)
      - GUI_PWD=admin
      - WEBUI_PWD=admin

      # opcional: reinicio diario del contenedor (no imprescindible)
      - MOD_AUTO_RESTART_ENABLED=true
      - MOD_AUTO_RESTART_CRON=0 6 * * *
      - MOD_AUTO_SHARE_ENABLED=false

      - MOD_FIX_KAD_GRAPH_ENABLED=true
      - MOD_FIX_KAD_BOOTSTRAP_ENABLED=true
    ports:
      - "4711:4711/tcp"
      - "4712:4712/tcp"
      - "4662:4662/tcp"
      - "4665:4665/udp"
      - "4672:4672/udp"
    volumes:
      - "E:/Docker_folders/amule/config:/home/amule/.aMule"
      - "E:/Docker_folders/amule/incoming:/incoming"
      - "E:/Docker_folders/amule/temp:/temp"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- metube
  # --- Descargas de YouTube (ytdl) con UI
  # --- Ports: 8081 (Gui Web)
  # --------------------------------------------------------
  metube:
    image: ghcr.io/alexta69/metube:latest
    container_name: metube
    restart: unless-stopped
    ports:
      - "8081:8081"          # UI web de MeTube
    environment:
      - TZ=Europe/Madrid
      # Opcional: explícito, pero por defecto ya usan /downloads
      - DOWNLOAD_DIR=/downloads
      - AUDIO_DOWNLOAD_DIR=/downloads/Music
    volumes:
      # Carpeta de descargas en el host -> carpeta interna de MeTube
      - "E:/YouTube:/downloads"
      - "E:/YouTube/Videos:/downloads/Videos"
      - "E:/YouTube/Music:/downloads/Music"

  # --------------------------------------------------------
  # --- tubearchivist
  # --- Archivo/descarga y gestión de YouTube
  # --- Ports: 8001 (Gui Web)
  # --------------------------------------------------------
  tubearchivist:
    image: bbilly1/tubearchivist:latest
    pull_policy: always
    container_name: tubearchivist
    restart: unless-stopped
    ports:
      - "8001:8000"
    volumes:
      - "E:/YouTube/Videos:/youtube"
      - "E:/Docker_folders/tubearchivist/cache:/cache"
    environment:
      - ES_URL=http://archivist-es:9200
      - REDIS_CON=redis://archivist-redis:6379
      - TA_HOST=${TA_HOST}
      - TA_USERNAME=${TA_USERNAME}
      - TA_PASSWORD=${TA_PASSWORD}
      - ELASTIC_PASSWORD=${ELASTIC_PASSWORD}
      - TZ=${TZ}
      # En Windows suele dar igual, pero lo dejo por compat con el compose oficial
      - HOST_UID=1000
      - HOST_GID=1000
    depends_on:
      - archivist-es
      - archivist-redis
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/api/health/"]
      interval: 2m
      timeout: 10s
      retries: 3
      start_period: 30s

  # --------------------------------------------------------
  # --- archivist-redis
  # --- Redis (cache/cola) para TubeArchivist
  # --- Ports: N/A
  # --------------------------------------------------------
  archivist-redis:
    image: redis:7-alpine
    pull_policy: always
    container_name: archivist-redis
    restart: unless-stopped
    expose:
      - "6379"
    volumes:
      - "E:/Docker_folders/tubearchivist/redis:/data"

  # --------------------------------------------------------
  # --- archivist-es
  # --- Elasticsearch para TubeArchivist
  # --- Ports: N/A
  # --------------------------------------------------------
  archivist-es:
    image: bbilly1/tubearchivist-es:latest
    pull_policy: always
    container_name: archivist-es
    restart: unless-stopped
    environment:
      - ELASTIC_PASSWORD=${ELASTIC_PASSWORD}
      - ES_JAVA_OPTS=-Xms2g -Xmx2g
      - xpack.security.enabled=true
      - discovery.type=single-node
      - path.repo=/usr/share/elasticsearch/data/snapshot
    ulimits:
      memlock:
        soft: -1
        hard: -1
    volumes:
      - "E:/Docker_folders/tubearchivist/es:/usr/share/elasticsearch/data"
    expose:
      - "9200"


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: AUTOMATIZACION MULTIMEDIA (ARR STACK, REQUESTS, NOTIFICACIONES, METADATOS)
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- sonarr
  # --- Automatización de series (Arr)
  # --- Ports: 33074 (Gui Web)
  # --------------------------------------------------------
  sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: sonarr
    ports:
      - "33074:8989"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/sonarr/sonarr_data:/config"
      - "E:/Docker_folders/sonarr/media_data:/downloads"
      - "F:/Series:/tv"
      - "E:/Series:/tv2"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- radarr
  # --- Automatización de películas (Arr)
  # --- Ports: 33075 (Gui Web)
  # --------------------------------------------------------
  radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: radarr
    ports:
      - "33075:7878"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/radarr/radarr_data:/config"
      - "E:/Docker_folders/radarr/media_data:/downloads"
      - "F:/Peliculas:/movies"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- bazarr
  # --- Subtítulos (Arr)
  # --- Ports: 33076 (Gui Web)
  # --------------------------------------------------------
  bazarr:
    image: lscr.io/linuxserver/bazarr:latest
    container_name: bazarr
    ports:
      - "33076:6767"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/bazarr/bazarr_data:/config"
      - "E:/Docker_folders/bazarr/media_data:/downloads"
      - "F:/Peliculas:/movies:ro"
      - "F:/Series:/tv:ro"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- lidarr
  # --- Automatización de música (Arr)
  # --- Ports: 33077 (Gui Web)
  # --------------------------------------------------------
  lidarr:
    image: lscr.io/linuxserver/lidarr:latest
    container_name: lidarr
    ports:
      - "33077:8686"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/lidarr/lidarr_data:/config"
      - "E:/Docker_folders/lidarr/media_data:/downloads"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- readarr
  # --- Automatización de libros (Arr)
  # --- Ports: 33078 (Gui Web)
  # --------------------------------------------------------
  readarr:
    image: ghcr.io/hotio/readarr:latest
    container_name: readarr
    ports:
      - "33078:8787"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/readarr/readarr_data:/config"
      - "E:/Docker_folders/readarr/descargas:/downloads"
      - "F:/Libros:/books"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- prowlarr
  # --- Indexers / agregador (Arr)
  # --- Ports: 33079 (Gui Web)
  # --------------------------------------------------------
  prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: prowlarr
    ports:
      - "33079:9696"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/prowlarr/prowlarr_data:/config"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- jackett
  # --- Indexers (Torznab) alternativo
  # --- Ports: 9117 (Gui Web)
  # --------------------------------------------------------
  jackett:
    image: lscr.io/linuxserver/jackett:latest
    container_name: jackett
    ports:
      - "9117:9117"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
      - AUTO_UPDATE=true
    volumes:
      - "E:/Docker_folders/jackett/jackett_data:/config"
      - "E:/Docker_folders/jackett/media_data:/downloads"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- jellyseerr
  # --- Requests de contenido para Jellyfin
  # --- Ports: 33080 (Gui Web)
  # --------------------------------------------------------
  jellyseerr:
    image: fallenbagel/jellyseerr:latest
    container_name: jellyseerr
    ports: ["33080:5055"]
    environment:
      - TZ=Europe/Madrid
      - LOG_LEVEL=info
    volumes:
      - "E:/Docker_folders/jellyseerr/jellyseerr_data:/app/config"
      - "E:/Docker_folders/jellyseerr/raiz:/raiz"
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "curl -fsS http://localhost:5055/api/v1/status >/dev/null || exit 1"]
      interval: 30s
      timeout: 5s
      retries: 5
      start_period: 20s

  # --------------------------------------------------------
  # --- recyclarr
  # --- Sincronización de perfiles/quality para Arr
  # --- Ports: N/A
  # --------------------------------------------------------
  recyclarr:
    image: ghcr.io/recyclarr/recyclarr:latest
    container_name: recyclarr
    environment:
      - TZ=Europe/Madrid
      - CRON_SCHEDULE=0 5 * * *
    volumes:
      - "E:/Docker_folders/recyclarr/recyclarr_config:/config"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- notifiarr
  # --- Notificaciones e integración con stack multimedia
  # --- Ports: 5454 (Gui Web)
  # --------------------------------------------------------
  notifiarr:
    image: golift/notifiarr:latest
    container_name: notifiarr
    ports:
      - "5454:5454"
    environment:
      - TZ=Europe/Madrid
      - PUID=1000
      - PGID=1000
    volumes:
      - "E:/Docker_folders/notifiarr/notifiarr_config:/config"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- amarr
  # --- Bridge/endpoint para aMule (Torznab/cliente simulado)
  # --- Ports: 33120 (Gui Web)
  # --------------------------------------------------------
  amarr:
    image: vexdev/amarr:latest
    container_name: amarr
    depends_on:
      - amule
    ports:
      - "33120:8080"   # UI/endpoint Torznab y cliente simulado
    environment:
      - AMULE_HOST=amule
      - AMULE_PORT=4712
      - AMULE_PASSWORD=${AMULE_GUI_PWD:-amuleadmin}  # coincide con GUI_PWD de aMule
      - AMARR_LOG_LEVEL=INFO
      - AMULE_FINISHED_PATH=/incoming                 # coincide con aMule
    volumes:
      - "E:/Docker_folders/amarr:/config"
    restart: unless-stopped


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: IPTV / EPG
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- webgrabplus
  # --- Generación/captura de EPG
  # --- Ports: N/A
  # --------------------------------------------------------
  webgrabplus:
    image: lscr.io/linuxserver/webgrabplus:latest
    container_name: webgrabplus
    hostname: webgrabplus
    mac_address: "4C-CC-6A-B5-C5-6B"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
      - DOCKER_MODS=linuxserver/mods:universal-cron
    volumes:
      - "E:/Docker_folders/webgrabplus/config:/config"
      - "E:/Docker_folders/epg:/data"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- dispatcharr
  # --- Gestor/servicio IPTV (bajo VPN gluetun)
  # --- Ports: N/A
  # --------------------------------------------------------
  dispatcharr:
    image: ghcr.io/dispatcharr/dispatcharr:latest
    container_name: dispatcharr
    network_mode: "service:gluetun"
    environment:
      - TZ=Europe/Madrid
      - DISPATCHARR_ENV=aio
      - DISPATCHARR_LOG_LEVEL=info
    volumes:
      - "E:/Docker_folders/dispatcharr/data:/data"
      - "E:/Docker_folders/dispatcharr/iptv:/data/m3us"
      - "E:/Docker_folders/epg:/data/epgs:ro"
    restart: unless-stopped

  nextpvr:
    image: nextpvr/nextpvr_amd64:latest
    container_name: nextpvr
    depends_on:
      - gluetun
      - dispatcharr
    environment:
      - TZ=Europe/Madrid
    ports:
      - "8866:8866"
      - "16891:16891/udp"
      - "8026:8026/udp"
    volumes:
      - "E:/Docker_folders/nextpvr/config:/config"
      - "E:/Grabaciones:/recordings"
      - "E:/Docker_folders/nextpvr/buffer:/buffer"
    restart: unless-stopped

  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: PROCESADO / TRANSCODIFICACION / UTILIDADES MULTIMEDIA
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- unmanic
  # --- Transcodificación/optimización automática
  # --- Ports: 8888 (Gui Web)
  # --------------------------------------------------------
  unmanic:
    image: josh5/unmanic:latest
    container_name: unmanic
    ports:
      - "8888:8888"
    environment:
      - TZ=Europe/Madrid
      - PUID=1000
      - PGID=1000
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=all
    volumes:
      - "E:/Docker_folders/unmanic/unmanic_config:/config"
      - "E:/Docker_folders/unmanic/media_data:/watch"
      - "F:/_Multimedia:/library"
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu,video,utility]
    restart: unless-stopped

  # --------------------------------------------------------
  # --- moverpelis
  # --- Script de utilidades: mover archivos descargados
  # --- Ports: N/A
  # --------------------------------------------------------
  moverpelis:
    image: alpine:3.20
    container_name: moverpelis
    command: >
      sh -c 'apk add --no-cache findutils coreutils >/dev/null
      && echo "$(date "+%F %T.%3N") | Monitoreando /watch -> /target (cada 15s, mueve archivos con >1 min sin cambios)..."
      && while :; do
           /usr/bin/find /watch -maxdepth 1 -type f -mmin +1 \
             -exec mv -n -t /target {} +
           sleep 15
         done'
    volumes:
      - "D:/Descargas/eMule/Incoming/pelis:/watch"
      - "E:/Peliculas:/target"
    restart: unless-stopped


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: MONITORIZACION / LOGS / UPTIME
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- uptime-kuma
  # --- Monitor de uptime y servicios
  # --- Ports: 3001 (Gui Web)
  # --------------------------------------------------------
  uptime-kuma:
    image: louislam/uptime-kuma:1
    container_name: uptime-kuma
    restart: unless-stopped
    ports:
      - "3001:3001"
    volumes:
      - "E:/Docker_folders/uptime_kuma/uptime_kuma_data:/app/data"

  # --------------------------------------------------------
  # --- dozzle
  # --- Logs en tiempo real (Docker)
  # --- Ports: 9999 (Gui Web)
  # --------------------------------------------------------
  dozzle:
    image: amir20/dozzle:latest
    container_name: dozzle
    ports:
      - "9999:8080"
    environment:
      - TZ=Europe/Madrid
      - DOZZLE_LEVEL=info
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    restart: unless-stopped

  # --------------------------------------------------------
  # --- netdata
  # --- Monitorización del host / métricas
  # --- Ports: 19999 (Gui Web)
  # --------------------------------------------------------
  netdata:
    image: netdata/netdata:stable
    container_name: netdata
    hostname: netdata
    ports:
      - "19999:19999"
    cap_add:
      - SYS_PTRACE
    security_opt:
      - apparmor:unconfined
    environment:
      - TZ=Europe/Madrid
    volumes:
      - "E:/Docker_folders/netdata/netdata_config:/etc/netdata"
      - "E:/Docker_folders/netdata/netdata_lib:/var/lib/netdata"
      - "E:/Docker_folders/netdata/netdata_cache:/var/cache/netdata"
      - /etc/passwd:/host/etc/passwd:ro
      - /etc/group:/host/etc/group:ro
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /etc/os-release:/host/etc/os-release:ro
    restart: unless-stopped

  # --------------------------------------------------------
  # --- jellystat
  # --- Estadísticas avanzadas Jellyfin
  # --- Ports: 3000 (Gui Web)
  # --------------------------------------------------------
  jellystat:
    image: cyfershepard/jellystat:latest
    container_name: jellystat
    depends_on:
      postgres:
        condition: service_healthy
    ports: ["3000:3000"]
    environment:
      - TZ=Europe/Madrid
      - POSTGRES_IP=postgres
      - POSTGRES_PORT=5432
      - POSTGRES_DB=jellystat
      - POSTGRES_USER=jellystat
      - POSTGRES_PASSWORD=${JELLYSTAT_DB_PASS}
      - JWT_SECRET=${JELLYSTAT_JWT}
      - JELLYFIN_URL=http://jellyfin:8096
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "curl -fsS http://localhost:3000 >/dev/null"]
      interval: 1m
      timeout: 5s
      retries: 3
      start_period: 20s


  # --------------------------------------------------------
  # --- vpn-ip-check
  # --- Comprobación de IP/VPN (logs)
  # --- Ports: N/A
  # --------------------------------------------------------
  vpn-ip-check:
    image: alpine:3.20
    container_name: vpn-ip-check
    network_mode: "service:gluetun"
    depends_on:
      - gluetun
    command: >
      sh -c "apk add --no-cache curl >/dev/null
      && while true; do
           echo '============================='
           date
           echo '[Mullvad check]'
           curl -s https://am.i.mullvad.net/json || true
           echo
           echo '[Public IP]'
           curl -s https://ipinfo.io/ip || true
           echo
           sleep 30
         done"
    restart: unless-stopped


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: GESTION DOCKER / INFRAESTRUCTURA
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- portainer
  # --- Gestión de Docker
  # --- Ports: 9443 (Gui Web)
  # --------------------------------------------------------
  portainer:
    image: portainer/portainer-ce:latest
    container_name: portainer
    ports:
      - "9443:9443"   # UI HTTPS (principal)
      - "9000:9000"   # UI HTTP (opcional)
      - "8000:8000"   # Edge tunnel (opcional)
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - "E:/Docker_folders/portainer/portainer_data:/data"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- test-gpu
  # --- Prueba de GPU (nvidia-smi)
  # --- Ports: N/A
  # --------------------------------------------------------
  test-gpu:
    image: nvidia/cuda:12.9.0-base-ubuntu22.04
    container_name: test-gpu
    command: >
      bash -lc "while true; do
        date;
        nvidia-smi;
        sleep 3600;
      done"
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    restart: "no"



  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: REDES, PROXY, DNS, VPN, DDNS
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- nginx-proxy-manager
  # --- Reverse proxy + gestión de hosts/SSL
  # --- Ports: 81 (Gui Web)
  # --------------------------------------------------------
  nginx-proxy-manager:
    image: jc21/nginx-proxy-manager:latest
    container_name: nginx-proxy-manager
    restart: unless-stopped
    ports:
      - "80:80"
      - "443:443"
      - "127.0.0.1:81:81"
    environment:
      - TZ=Europe/Madrid
      - INITIAL_ADMIN_EMAIL=admin@admin.com
      - INITIAL_ADMIN_PASSWORD=admin123
      - DISABLE_IPV6=true
    volumes:
      - "E:/Docker_folders/nginx/npm_data:/data"
      - "E:/Docker_folders/nginx/npm_letsencrypt:/etc/letsencrypt"

  # --------------------------------------------------------
  # --- cloudflared
  # --- container for coludflare tunnel (ssh)
  # --- Ports: N/A
  # --------------------------------------------------------
  cloudflared:
    image: cloudflare/cloudflared:latest
    container_name: cloudflared
    restart: unless-stopped
    command: tunnel --no-autoupdate run --token ${CF_TUNNEL_TOKEN}
    depends_on:
      - nginx-proxy-manager

  # --------------------------------------------------------
  # --- gluetun
  # --- VPN (WireGuard/Mullvad) + firewall
  # --- Ports: N/A
  # --------------------------------------------------------
  gluetun:
    image: qmcgaw/gluetun:latest
    container_name: gluetun
    cap_add:
      - NET_ADMIN
    environment:
      - TZ=Europe/Madrid
      # --- Mullvad WireGuard ---
      - VPN_SERVICE_PROVIDER=mullvad
      - VPN_TYPE=wireguard
      - WIREGUARD_PRIVATE_KEY=${WIREGUARD_PRIVATE_KEY}
      - WIREGUARD_ADDRESSES=${WIREGUARD_ADDRESSES}
      # --- Forzar salida ---
      - SERVER_COUNTRIES=Finland
      - SERVER_CITIES=Helsinki
      # Usar el DNS que dio Mullvad en el .conf
      - DNS_ADDRESS=${DNS_ADDRESS}
      # Firewall
      - FIREWALL_INPUT_PORTS=9981,9982,9191
    ports:
      - "127.0.0.1:31377:8000"
      - "9981:9981"
      - "9982:9982"
      - "9191:9191"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- cloudflare-ddns
  # --- DDNS para Cloudflare
  # --- Ports: N/A
  # --------------------------------------------------------
  cloudflare-ddns:
    image: favonia/cloudflare-ddns:latest
    container_name: cloudflare-ddns
    restart: unless-stopped
    environment:
      - CLOUDFLARE_API_TOKEN=${CF_DDNS_TOKEN}
      - DOMAINS=maripiflix.xyz
      - PROXIED=false
      - IP6_PROVIDER=none
      - UPDATE_CRON=@every 5m


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: IA Y BUSQUEDA
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- searxng
  # --- Metabuscador (self-hosted)
  # --- Ports: 4080 (Gui Web)
  # --------------------------------------------------------
  searxng:
    image: searxng/searxng:latest
    container_name: searxng
    restart: unless-stopped
    ports:
      - "4080:8080"
    environment:
      - SEARXNG_BASE_URL=http://localhost:4080
      # - SEARXNG_SECRET=CAMBIA_ESTA_CLAVE_LARGA_Y_UNICA
    volumes:
      - "E:/Docker_folders/SearXNG/config:/etc/searxng"
      - "E:/Docker_folders/SearXNG/cache:/var/cache/searxng"

  # --------------------------------------------------------
  # --- qdrant
  # --- Vector DB (RAG/embeddings)
  # --- Ports: 6333 (Gui Web)
  # --------------------------------------------------------
  qdrant:
    image: qdrant/qdrant
    hostname: qdrant
    container_name: qdrant
    restart: unless-stopped
    ports:
      - 6333:6333
    volumes:
      - "E:/Docker_folders/qdrant/qdrant_storage:/qdrant/storage"

  # --------------------------------------------------------
  # --- ollama-cpu
  # --- LLM server (API)
  # --- Ports: N/A
  # --------------------------------------------------------
  ollama-cpu:
    profiles: ["cpu"]
    image: ollama/ollama:latest
    container_name: ollama
    restart: unless-stopped
    ports:
      - 11000:11434
    volumes:
      - "E:/Docker_folders/ollama:/root/.ollama"

  # --------------------------------------------------------
  # --- ollama-gpu
  # --- LLM server (API) con GPU NVIDIA
  # --- Ports: N/A
  # --------------------------------------------------------
  ollama-gpu:
    profiles: ["gpu-nvidia"]
    image: ollama/ollama:latest
    container_name: ollama
    restart: unless-stopped
    ports:
      - 11000:11434
    volumes:
      - "E:/Docker_folders/ollama:/root/.ollama"
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

  # --------------------------------------------------------
  # --- ollama-gpu-amd
  # --- LLM server (API) con GPU AMD
  # --- Ports: N/A
  # --------------------------------------------------------
  ollama-gpu-amd:
    profiles: ["gpu-amd"]
    image: ollama/ollama:latest
    container_name: ollama
    restart: unless-stopped
    ports:
      - 11000:11434
    volumes:
      - "E:/Docker_folders/ollama:/root/.ollama"
    devices:
      - "/dev/kfd"
      - "/dev/dri"


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: BASES DE DATOS
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- postgres
  # --- PostgreSQL (general)
  # --- Ports: 5432
  # --------------------------------------------------------
  postgres:
    image: postgres:16-alpine
    container_name: postgres
    hostname: postgres
    restart: unless-stopped
    environment:
      - TZ=Europe/Madrid
      - POSTGRES_USER=${POSTGRES_ADMIN_USER}
      - POSTGRES_PASSWORD=${POSTGRES_ADMIN_PASSWORD}
      - POSTGRES_DB=postgres
    volumes:
      - "E:/Docker_folders/postgres/postgres_storage:/var/lib/postgresql/data"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -h 127.0.0.1 -p 5432 -U ${POSTGRES_ADMIN_USER} -d postgres"]
      interval: 20s
      timeout: 10s
      retries: 10
      start_period: 60s
    ports:
       - "5432:5432"

  # --------------------------------------------------------
  # --- guacamole-initdb
  # --- inicializa la base de datos de guacamole
  # --- Ports: N/A
  # --------------------------------------------------------
  guacamole-initdb:
    image: guacamole/guacamole:latest
    profiles: ["provision"]
    container_name: guacamole-initdb
    command: >
      sh -c "/opt/guacamole/bin/initdb.sh --postgresql > /schemas/guacamole-initdb.sql"
    volumes:
      - "E:/Docker_folders/postgres/provisioner/schemas:/schemas"
    restart: "no"

  # --------------------------------------------------------
  # --- pg-provisioner
  # --- provisionador de bases de datos se configura con databases.yml
  # --- Ports: N/A
  # --------------------------------------------------------
  pg-provisioner:
    profiles: ["provision"]
    build:
      context: "E:/Docker_folders/postgres/provisioner"
      dockerfile: Dockerfile
    container_name: pg-provisioner
    depends_on:
      postgres:
        condition: service_healthy
      guacamole-initdb:
        condition: service_completed_successfully
    env_file:
      - path: .env
        required: true
    environment:
      - PGHOST=postgres
      - PGPORT=5432
      - PGUSER=${POSTGRES_ADMIN_USER}
      - PGPASSWORD=${POSTGRES_ADMIN_PASSWORD}
      - DB_REGISTRY=/config/databases.yml
    volumes:
      - "E:/Docker_folders/postgres/provisioner:/config:ro"
      - "E:/Docker_folders/postgres/provisioner/schemas:/schemas:ro"
    restart: "no"


  # --------------------------------------------------------
  # --- romm-db
  # --- MariaDB (RomM)
  # --- Ports: N/A
  # --------------------------------------------------------
  romm-db:
    image: mariadb:11
    container_name: romm-db
    restart: unless-stopped
    environment:
      - MARIADB_ROOT_PASSWORD=${ROMM_DB_ROOT_PASS}
      - MARIADB_DATABASE=romm
      - MARIADB_USER=admin
      - MARIADB_PASSWORD=${ROMM_DB_PASS}
    volumes:
      - romm_db_data:/var/lib/mysql  # <-- volumen nombrado (NO ruta de Windows)
    healthcheck:
      test: ["CMD", "healthcheck.sh", "--connect", "--innodb_initialized"]
      start_period: 240s   # antes 30s
      interval: 20s        # antes 10s
      timeout: 10s         # antes 5s
      retries: 10          # antes 5


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: AUTOMATIZACION / RUNNERS / SCHEDULING
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- n8n
  # --- Automatización de workflows
  # --- Ports: 5678 (Gui Web)
  # --------------------------------------------------------
  n8n:
    hostname: n8n
    container_name: n8n
    restart: unless-stopped
    image: n8nio/n8n:latest
    environment:
      - DB_TYPE=postgresdb
      - DB_POSTGRESDB_HOST=postgres
      - DB_POSTGRESDB_PORT=5432
      - DB_POSTGRESDB_DATABASE=${POSTGRES_N8N_DB}
      - DB_POSTGRESDB_USER=${POSTGRES_N8N_USER}
      - DB_POSTGRESDB_PASSWORD=${POSTGRES_N8N_PASSWORD}

      - N8N_RUNNERS_ENABLED=true
      - N8N_BLOCK_ENV_ACCESS_IN_NODE=true
      - N8N_GIT_NODE_DISABLE_BARE_REPOS=true
      - N8N_DIAGNOSTICS_ENABLED=false
      - N8N_PERSONALIZATION_ENABLED=false
      - N8N_ENCRYPTION_KEY=${N8N_ENCRYPTION_KEY}
      - N8N_USER_MANAGEMENT_JWT_SECRET=${N8N_USER_MANAGEMENT_JWT_SECRET}
      - OLLAMA_HOST=${OLLAMA_HOST:-ollama:11434}
      - N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true
    env_file:
      - path: .env
        required: true
    ports:
      - 5678:5678
    volumes:
      - "E:/Docker_folders/n8n/n8n_storage:/home/node/.n8n"
      - "E:/Docker_folders/n8n/n8n/demo-data:/demo-data"
      - "E:/Docker_folders/n8n/shared:/data/shared"
    depends_on:
      postgres:
        condition: service_healthy


  # --------------------------------------------------------
  # --- cronicle
  # --- Scheduler / job runner con UI
  # --- Ports: 3012 (Gui Web)
  # --------------------------------------------------------
  cronicle:
    image: bluet/cronicle-docker:latest
    container_name: cronicle
    hostname: cronicle
    environment:
      - TZ=Europe/Madrid
      - CRONICLE_base_app_url=http://localhost:3012
      - CRONICLE_foreground=1
      - CRONICLE_echo=1
      - CRONICLE_secret_key=admin
      - DOCKER_HOST=unix:///var/run/docker.sock
      - CRONICLE_web_direct_connect=0
    ports:
      - "3012:3012"
    volumes:
      # Persistencia Cronicle
      - "E:/Docker_folders/cronicle/data:/opt/cronicle/data"
      - "E:/Docker_folders/cronicle/logs:/opt/cronicle/logs"
      - "E:/Docker_folders/cronicle/plugins:/opt/cronicle/plugins"
      - "E:/Docker_folders/cronicle/app:/app"
      # Tus scripts (wrappers, python, etc.)
      - "E:/Docker_folders/cronicle/scripts:/scripts"
      # Acceso al Docker daemon (ojo: esto da mucho poder)
      - "/var/run/docker.sock:/var/run/docker.sock"
      # === TUS RUTAS “PESADAS” ===
      # Monta E: y F: completos:
      - "E:/:/host/E"
      - "F:/:/host/F"
      # Ruta específica eMule
      - "D:/Descargas/eMule:/host/eMule"
    restart: unless-stopped


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: PODCASTS / MUSICA / RSS / FEEDS
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- gpodder
  # --- Gestión/descarga de podcasts
  # --- Ports: 33131 (Gui Web)
  # --------------------------------------------------------
  gpodder:
    image: xthursdayx/gpodder-docker:latest
    container_name: gpodder
    environment:
      - TZ=Europe/Madrid
      - PUID=1000
      - PGID=1000
      - PASSWORD=${GPODDER_PASS}
    ports:
      - "33131:3000"     # tú ya lo tienes en 33131
    volumes:
      - "E:/Docker_folders/gpodder/config:/config"
      - "E:/Docker_folders/gpodder/downloads:/downloads"     # caché de gPodder (NO jellyfin)
      - "F:/Podcasts:/jellyfin_podcasts"                     # salida para Jellyfin
    restart: unless-stopped

  # --------------------------------------------------------
  # --- beets
  # --- Organización/tagging de música (integración Jellyfin)
  # --- Ports: 8337 (Gui Web)
  # --------------------------------------------------------
  beets:
    image: lscr.io/linuxserver/beets:latest
    container_name: beets
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
      - JELLYFIN_URL=http://jellyfin:8096
      - JELLYFIN_API_KEY=${JELLYFIN_API_KEY_BEETS}
      - ACOUSTID_API_KEY=${ACOUSTID_API_KEY}
    volumes:
      - "E:/Docker_folders/beets:/config"
      - "F:/Musica:/music"
      - "E:/YouTube/Music/downloads:/downloads"
    ports:
      - "8337:8337"
    dns:
      - 1.1.1.1
      - 8.8.8.8
    restart: unless-stopped

  # --------------------------------------------------------
  # --- rss-bridge
  # --- Generador/puente RSS
  # --- Ports: 33137 (Gui Web)
  # --------------------------------------------------------
  rss-bridge:
    image: rssbridge/rss-bridge:latest
    container_name: rss-bridge
    ports:
      - "33137:80"
    volumes:
      - "E:/Docker_folders/rss-bridge:/config"
    restart: unless-stopped


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: ARCHIVOS, EXPLORACION Y TRANSFERENCIA
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- sftpgo
  # --- SFTP + Web Admin/Web Client
  # --- Ports: 33160 (Gui Web)
  # --------------------------------------------------------
  sftpgo:
    image: drakkan/sftpgo:latest
    container_name: sftpgo
    restart: unless-stopped
    environment:
      - TZ=Europe/Madrid
      - SFTPGO_LOG_LEVEL=info
    ports:
      - "33160:8080"   # Web Admin + Web Client
      - "33222:2022"   # SFTP
    volumes:
      # Persistencia SFTPGo
      - "E:/Docker_folders/sftpgo/srv:/srv/sftpgo"
      - "E:/Docker_folders/sftpgo/home:/var/lib/sftpgo"
      # Monta UNIDADES COMPLETAS (E y F) dentro del contenedor
      - "E:/:/storage/E"
      - "F:/:/storage/F"

  # --------------------------------------------------------
  # --- filezilla
  # --- Cliente FTP/SFTP con GUI web (noVNC)
  # --- Ports: 33161 (Gui Web)
  # --------------------------------------------------------
  filezilla:
    image: jlesage/filezilla:latest
    container_name: filezilla
    restart: unless-stopped
    environment:
      - TZ=Europe/Madrid
      - SECURE_CONNECTION=1
      - WEB_AUTHENTICATION=1
      - WEB_AUTHENTICATION_USERNAME=${FILEZILLA_WEB_USER}
      - WEB_AUTHENTICATION_PASSWORD=${FILEZILLA_WEB_PASS}
    ports:
      - "33161:5800"     # GUI web: http://HOST:33161
      # - "33162:5900"   # (Opcional) VNC si quieres
    volumes:
      - "E:/Docker_folders/filezilla:/config:rw"
      # Monta E y F enteras para navegar desde FileZilla (lado local)
      - "E:/:/storage/E:rw"
      - "F:/:/storage/F:rw"

  # --------------------------------------------------------
  # --- filestash
  # --- Explorador de archivos web
  # --- Ports: 8334 (Gui Web)
  # --------------------------------------------------------
  filestash:
    image: machines/filestash:latest
    container_name: filestash
    restart: unless-stopped
    ports:
      - "8334:8334"
    environment:
      - APPLICATION_URL=
      - OFFICE_URL=http://filestash_wopi:9980
      - OFFICE_FILESTASH_URL=http://filestash:8334
      - OFFICE_REWRITE_URL=http://localhost:9980
    volumes:
      # Persistencia Filestash
      - "E:/Docker_folders/filestash/state:/app/data/state"
      - "E:/Docker_folders/filestash/files:/app/data/files"
      # Mapeos de tus rutas
      - "E:/:/mnt/host/E"
      - "F:/:/mnt/host/F"
      - "D:/Descargas:/mnt/host/Descargas"
    depends_on:
      - filestash_wopi

  # --------------------------------------------------------
  # --- filestash_wopi
  # --- filestash para documentos de ofimatica
  # --- Ports: 9980 (Gui Web)
  # --------------------------------------------------------
  filestash_wopi:
    image: collabora/code:24.04.10.2.1
    container_name: filestash_wopi
    restart: unless-stopped
    environment:
      - "extra_params=--o:ssl.enable=false"
      - 'aliasgroup1="https://.*:443"'
    command:
      - /bin/bash
      - -c
      - |
        curl -o /usr/share/coolwsd/browser/dist/branding-desktop.css https://gist.githubusercontent.com/mickael-kerjean/bc1f57cd312cf04731d30185cc4e7ba2/raw/d706dcdf23c21441e5af289d871b33defc2770ea/destop.css
        /bin/su -s /bin/bash -c '/start-collabora-online.sh' cool
    user: root
    ports:
      - "9980:9980"


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: DESARROLLO / HERRAMIENTAS API
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- swagger-ui
  # --- Visualizador de OpenAPI/Swagger
  # --- Ports: 33150 (Gui Web)
  # --------------------------------------------------------
  swagger-ui:
    image: swaggerapi/swagger-ui:latest
    container_name: swagger-ui
    restart: unless-stopped
    ports:
      - "33150:8080"
    volumes:
      # Tus OpenAPI specs (yaml/json)
      - "E:/Docker_folders/swagger/specs:/usr/share/nginx/html/specs:ro"
      # Sobrescribe el inicializador para mostrar un selector con varias APIs
      - "E:/Docker_folders/swagger/ui/swagger-initializer.js:/usr/share/nginx/html/swagger-initializer.js:ro"

  # --------------------------------------------------------
  # --- swagger-editor
  # --- Editor de OpenAPI/Swagger
  # --- Ports: 33154 (Gui Web)
  # --------------------------------------------------------
  swagger-editor:
    image: swaggerapi/swagger-editor:latest
    container_name: swagger-editor
    restart: unless-stopped
    ports:
      - "33154:80"

  # --------------------------------------------------------
  # --- cloudbeaver
  # --- UI web para bases de datos (DBeaver)
  # --- Ports: 18978 (Gui Web)
  # --------------------------------------------------------
  cloudbeaver:
    image: dbeaver/cloudbeaver:latest
    container_name: cloudbeaver
    restart: unless-stopped
    ports:
      - "18978:8978"
    environment:
      - CB_SERVER_NAME=cloudbeaver
      - CB_SERVER_URL=https://cloudbeaver:8978
    volumes:
      - "E:/Docker_folders/cloudbeaver/cloudbeaver_workspace:/opt/cloudbeaver/workspace"
      - "E:/Docker_folders/jellifyn/metadata:/mnt/jellyfin:ro"
    depends_on:
      postgres:
        condition: service_healthy

  # --------------------------------------------------------
  # --- openvscode
  # --- IDE web (OpenVSCode Server)
  # --- Ports: 33191 (Gui Web)
  # --------------------------------------------------------
  openvscode:
    image: gitpod/openvscode-server:latest
    container_name: openvscode
    ports:
      - "33191:3000"
    volumes:
      - "E:/Docker_folders/repos:/home/workspace"
    restart: unless-stopped

  # --------------------------------------------------------
  # --- github-desktop
  # --- GitHub Desktop en web (noVNC)
  # --- Ports: 33192 (Gui Web)
  # --------------------------------------------------------
  github-desktop:
    image: lscr.io/linuxserver/github-desktop:latest
    container_name: github-desktop
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Madrid
      # Auth básica opcional (recomendable al menos en LAN)
      - CUSTOM_USER=${GHD_USER}
      - PASSWORD=${GHD_PASS}
    volumes:
      - "E:/Docker_folders/github-desktop/config:/config"
      # Aquí montas donde quieras tener/clonar repos
      - "E:/Docker_folders/repos:/repos"
    ports:
      - "33192:3000"   # HTTP (pensado para ir detrás de proxy)
      - "33193:3001"   # HTTPS directo (cert self-signed)
    shm_size: "1gb"
    cap_add:
      - IPC_LOCK
    restart: unless-stopped


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: ACCESO REMOTO
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- guacd
  # --- Daemon RDP/VNC/SSH para Guacamole
  # --- Ports: N/A
  # --------------------------------------------------------
  guacd:
    image: guacamole/guacd:latest
    container_name: guacd
    restart: unless-stopped

  # --------------------------------------------------------
  # --- guacamole
  # --- Acceso remoto vía web (RDP/VNC/SSH)
  # --- Ports: 33170 (Gui Web)
  # --------------------------------------------------------
  guacamole:
    image: guacamole/guacamole:latest
    container_name: guacamole
    restart: unless-stopped
    depends_on:
      guacd:
        condition: service_started
      postgres:
        condition: service_healthy
    ports:
      - "33170:8080"
    environment:
      # Guacd (daemon)
      GUACD_HOSTNAME: guacd
      GUACD_PORT: 4822
      # PostgreSQL auth (DB)
      POSTGRESQL_ENABLED: "true"
      POSTGRESQL_HOSTNAME: postgres
      POSTGRESQL_PORT: 5432
      POSTGRESQL_DATABASE: guacamole_db
      POSTGRESQL_USERNAME: guacamole_user
      POSTGRESQL_PASSWORD: ${GUACAMOLE_DB_PASS}
      # Opcional
      BAN_ENABLED: "false"
      # Conexion remota
      WEBAPP_CONTEXT: "ROOT"
      REMOTE_IP_VALVE_ENABLED: "true"
    volumes:
      - "E:/Docker_folders/guacamole/extensions:/etc/guacamole/extensions"
      - "E:/Docker_folders/guacamole/lib:/etc/guacamole/lib"


  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: SEGURIDAD Y CREDENCIALES
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- bitwarden-lite
  # --- Gestor de contraseñas (servido por proxy)
  # --- Ports: N/A
  # --------------------------------------------------------
  bitwarden-lite:
    image: ghcr.io/bitwarden/lite:latest
    container_name: bitwarden-lite
    restart: unless-stopped
    depends_on:
      postgres:
        condition: service_healthy
    environment:
      TZ: Europe/Madrid
      BW_DOMAIN: ${BW_DOMAIN}
      # DB
      BW_DB_PROVIDER: postgresql
      BW_DB_SERVER: postgres
      BW_DB_PORT: 5432
      BW_DB_DATABASE: bitwarden
      BW_DB_USERNAME: bitwarden
      BW_DB_PASSWORD: ${BW_DB_PASSWORD}
      # Instalación Bitwarden
      BW_INSTALLATION_ID: ${BW_INSTALLATION_ID}
      BW_INSTALLATION_KEY: ${BW_INSTALLATION_KEY}
      # IMPORTANTE: primero "false" para crear tu usuario, luego lo pones "true"
      globalSettings__disableUserRegistration: "false"
    volumes:
      - "E:/Docker_folders/bitwarden-lite:/etc/bitwarden"
    ports:
      - "65121:8080"
    healthcheck:
      test: ["CMD-SHELL", "wget -qO- http://localhost:8080 >/dev/null 2>&1 || exit 1"]
      interval: 30s
      timeout: 5s
      retries: 5
      start_period: 60s



  # +++++++++++++++++++++++++++++++
  #
  # CATEGORIA: GAMING / ROMS Y BIBLIOTECA DE VIDEOJUEGOS
  #
  # +++++++++++++++++++++++++++++++

  # --------------------------------------------------------
  # --- romm
  # --- Biblioteca web de ROMs / videojuegos
  # --- Ports: 33110 (Gui Web)
  # --------------------------------------------------------
  romm:
    image: rommapp/romm:latest
    container_name: romm
    restart: unless-stopped
    depends_on:
      romm-db:
        condition: service_healthy
    environment:
      - DB_HOST=romm-db
      - DB_PORT=3306
      - DB_NAME=romm
      - DB_USER=admin                # <-- igual que el creado por MariaDB
      - DB_PASSWD=${ROMM_DB_PASS}    # <-- usa la MISMA pass que MARIADB_PASSWORD en romm-db
      - ROMM_AUTH_SECRET_KEY=${ROMM_AUTH_SECRET_KEY}
      - STEAMGRIDDB_API_KEY=${STEAMGRIDDB_API_KEY}
      - IGDB_CLIENT_ID=${IGDB_CLIENT_ID}
      - IGDB_CLIENT_SECRET=${IGDB_CLIENT_SECRET}
      - SCREENSCRAPER_USER=${SCREENSCRAPER_USER}
      - SCREENSCRAPER_PASSWORD=${SCREENSCRAPER_PASSWORD}
    volumes:
      - "E:/Docker_folders/romm/romm_resources:/romm/resources"
      - "E:/Docker_folders/romm/romm_redis_data:/redis-data"
      - "E:/ROMM/library:/romm/library"
      - "E:/ROMM/assets:/romm/assets"
      - "E:/ROMM/config:/romm/config"
    ports:
      - "33110:8080"
